!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.AnalectsSDK=e():t.AnalectsSDK=e()}("undefined"!=typeof self?self:this,function(){return function(){"use strict";var t={d:function(e,n){for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},o:function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}},e={};function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach(function(e){s(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function s(t,e,n){return(e=v(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,a,s,i,c=[],o=!0,l=!1;try{if(s=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;o=!1}else for(;!(o=(r=s.call(n)).done)&&(c.push(r.value),c.length!==e);o=!0);}catch(t){l=!0,a=t}finally{try{if(!o&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return c}}(t,e)||o(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t){return function(t){if(Array.isArray(t))return l(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||o(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){if(t){if("string"==typeof t)return l(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(t,e):void 0}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function u(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function s(n,r,a,s){var o=r&&r.prototype instanceof c?r:c,l=Object.create(o.prototype);return d(l,"_invoke",function(n,r,a){var s,c,o,l=0,u=a||[],d=!1,h={p:0,n:0,v:t,a:f,f:f.bind(t,4),d:function(e,n){return s=e,c=0,o=t,h.n=n,i}};function f(n,r){for(c=n,o=r,e=0;!d&&l&&!a&&e<u.length;e++){var a,s=u[e],f=h.p,p=s[2];n>3?(a=p===r)&&(o=s[(c=s[4])?5:(c=3,3)],s[4]=s[5]=t):s[0]<=f&&((a=n<2&&f<s[1])?(c=0,h.v=r,h.n=s[1]):f<p&&(a=n<3||s[0]>r||r>p)&&(s[4]=n,s[5]=r,h.n=p,c=0))}if(a||n>1)return i;throw d=!0,r}return function(a,u,p){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&f(u,p),c=u,o=p;(e=c<2?t:o)||!d;){s||(c?c<3?(c>1&&(h.n=-1),f(c,o)):h.n=o:h.v=o);try{if(l=2,s){if(c||(a="next"),e=s[a]){if(!(e=e.call(s,o)))throw TypeError("iterator result is not an object");if(!e.done)return e;o=e.value,c<2&&(c=0)}else 1===c&&(e=s.return)&&e.call(s),c<2&&(o=TypeError("The iterator does not provide a '"+a+"' method"),c=1);s=t}else if((e=(d=h.n<0)?o:n.call(r,h))!==i)break}catch(e){s=t,c=1,o=e}finally{l=1}}return{value:e,done:d}}}(n,a,s),!0),l}var i={};function c(){}function o(){}function l(){}e=Object.getPrototypeOf;var h=[][r]?e(e([][r]())):(d(e={},r,function(){return this}),e),f=l.prototype=c.prototype=Object.create(h);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,d(t,a,"GeneratorFunction")),t.prototype=Object.create(f),t}return o.prototype=l,d(f,"constructor",l),d(l,"constructor",o),o.displayName="GeneratorFunction",d(l,a,"GeneratorFunction"),d(f),d(f,a,"Generator"),d(f,r,function(){return this}),d(f,"toString",function(){return"[object Generator]"}),(u=function(){return{w:s,m:p}})()}function d(t,e,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(t){a=0}d=function(t,e,n,r){function s(e,n){d(t,e,function(t){return this._invoke(e,n,t)})}e?a?a(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(s("next",0),s("throw",1),s("return",2))},d(t,e,n,r)}function h(t,e,n,r,a,s,i){try{var c=t[s](i),o=c.value}catch(t){return void n(t)}c.done?e(o):Promise.resolve(o).then(r,a)}function f(t){return function(){var e=this,n=arguments;return new Promise(function(r,a){var s=t.apply(e,n);function i(t){h(s,r,a,i,c,"next",t)}function c(t){h(s,r,a,i,c,"throw",t)}i(void 0)})}}function p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,v(r.key),r)}}function v(t){var e=function(t,e){if("object"!=n(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var a=r.call(t,e||"default");if("object"!=n(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==n(e)?e:e+""}t.d(e,{default:function(){return y}});var y=function(){return t=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.supabaseUrl=e.supabaseUrl||"",this.supabaseKey=e.supabaseKey||"",this.apiBaseUrl=this.supabaseUrl?"".concat(this.supabaseUrl,"/rest/v1"):"",this.headers={apikey:this.supabaseKey,Authorization:"Bearer ".concat(this.supabaseKey),"Content-Type":"application/json",Prefer:"return=representation,count=exact"},this.state={didSearch:!1,page:0,pageSize:10,hasMore:!1,totalCount:0,isLoading:!1,currentFilters:null,searchToken:0},this.cache={characters:null,arguments:null,proverbs:null,chapters:null},this.selected={chapter:{id:"all",name:"å…¨éƒ¨ç« èŠ‚"},characters:new Map,arguments:new Map,proverbs:new Map}},e=[{key:"_fetch",value:(y=f(u().m(function t(e){var n,r,a,s,i;return u().w(function(t){for(;;)switch(t.n){case 0:if(this.supabaseUrl&&this.supabaseKey){t.n=1;break}throw new Error("Supabase é…ç½®æ— æ•ˆï¼šè¯·åœ¨åˆå§‹åŒ–æ—¶ä¼ å…¥ supabaseUrl ä¸ supabaseKey");case 1:return t.n=2,fetch(e,{headers:this.headers});case 2:if((n=t.v).ok){t.n=4;break}return t.n=3,n.text().catch(function(){return""});case 3:throw r=t.v,new Error("è¯·æ±‚å¤±è´¥ ".concat(n.status,": ").concat(r||n.statusText));case 4:return a=n.headers.get("content-range"),s=a&&a.includes("/")?parseInt(a.split("/").pop(),10):null,t.n=5,n.json();case 5:return i=t.v,t.a(2,{data:i,total:s})}},t,this)})),function(t){return y.apply(this,arguments)})},{key:"_getOptions",value:(v=f(u().m(function t(e){var n,r,a,s,i,c=arguments;return u().w(function(t){for(;;)switch(t.n){case 0:if(n=c.length>1&&void 0!==c[1]?c[1]:function(t){return{id:t.id,name:t.name||t.title||t.content}},!this.cache[e]){t.n=1;break}return t.a(2,this.cache[e]);case 1:return r="".concat(this.apiBaseUrl,"/").concat(e,"?select=id,name,title,content&order=id.asc&limit=1000"),t.n=2,this._fetch(r);case 2:return a=t.v,s=a.data,i=(Array.isArray(s)?s:[]).map(n).filter(function(t){return t&&null!=t.id}),this.cache[e]=i,t.a(2,i)}},t,this)})),function(t){return v.apply(this,arguments)})},{key:"getCharacters",value:function(){return this._getOptions("characters")}},{key:"getArguments",value:function(){return this._getOptions("arguments")}},{key:"getProverbs",value:function(){return this._getOptions("proverbs")}},{key:"getChapters",value:(h=f(u().m(function t(){var e,n,r,a,s;return u().w(function(t){for(;;)switch(t.n){case 0:if(!this.cache.chapters){t.n=1;break}return t.a(2,this.cache.chapters);case 1:return e="".concat(this.apiBaseUrl,"/analects_entries?select=chapter&order=chapter.asc&limit=10000"),t.n=2,this._fetch(e);case 2:return n=t.v,r=n.data,a=new Set,(r||[]).forEach(function(t){t&&null!=t.chapter&&a.add(String(t.chapter))}),s=Array.from(a).map(function(t,e){return{id:t,name:t}}),this.cache.chapters=s,t.a(2,s)}},t,this)})),function(){return h.apply(this,arguments)})},{key:"_buildEntriesUrl",value:function(t,e,n){var r="".concat(this.apiBaseUrl,"/analects_entries?select=").concat(encodeURIComponent("id,chapter,section_number,original_text,translation,annotation,entry_characters(character_id),entry_arguments(argument_id),entry_proverbs(proverb_id)"),"&order=id.asc"),a=[];if(t.keyword){var s=t.keyword.trim();if(s){var i=encodeURIComponent("(original_text.ilike.*".concat(s,"*,translation.ilike.*").concat(s,"*,annotation.ilike.*").concat(s,"*)"));a.push("or=".concat(i))}}return t.chapter&&"all"!==t.chapter&&a.push("chapter=eq.".concat(encodeURIComponent(t.chapter))),a.push("limit=".concat(n)),a.push("offset=".concat(e*n)),a.length&&(r+="&"+a.join("&")),r}},{key:"fetchEntries",value:(d=f(u().m(function t(e){var n,r,a,s,i,o,l,d,h,f=arguments;return u().w(function(t){for(;;)switch(t.n){case 0:return n=f.length>1&&void 0!==f[1]?f[1]:0,r=f.length>2&&void 0!==f[2]?f[2]:10,a=this._buildEntriesUrl(e,n,r),t.n=1,this._fetch(a);case 1:return s=t.v,i=s.data,o=s.total,l=Array.isArray(i)?i:[],d=function(t,e){return c(t).every(function(t){return e.includes(parseInt(t,10))})},e.characterIds&&e.characterIds.length&&(l=l.filter(function(t){var n=(t.entry_characters||[]).map(function(t){return t.character_id}).filter(function(t){return null!=t});return d(e.characterIds,n)})),e.argumentIds&&e.argumentIds.length&&(l=l.filter(function(t){var n=(t.entry_arguments||[]).map(function(t){return t.argument_id}).filter(function(t){return null!=t});return d(e.argumentIds,n)})),e.proverbIds&&e.proverbIds.length&&(l=l.filter(function(t){var n=(t.entry_proverbs||[]).map(function(t){return t.proverb_id}).filter(function(t){return null!=t});return d(e.proverbIds,n)})),e.keyword&&(h=e.keyword.trim().toLowerCase(),l=l.filter(function(t){var e=(t.original_text||"").toLowerCase(),n=(t.translation||"").toLowerCase(),r=(t.annotation||"").toLowerCase();return e.includes(h)||n.includes(h)||r.includes(h)})),t.a(2,{data:l,totalCount:"number"==typeof o?o:l.length,hasMore:l.length===r})}},t,this)})),function(t){return d.apply(this,arguments)})},{key:"renderDailyAnalect",value:(l=f(u().m(function t(e){var n,r,a,s,i,c,o,l,d,h,f;return u().w(function(t){for(;;)switch(t.p=t.n){case 0:if(e){t.n=1;break}return t.a(2);case 1:return e.innerHTML='<div class="analects-card"><div class="analects-loading">åŠ è½½æ¯æ—¥è®ºè¯­...</div></div>',t.p=2,n="".concat(this.apiBaseUrl,"/analects_entries?select=id"),t.n=3,this._fetch(n);case 3:if(r=t.v,a=r.total,s="number"==typeof a?a:0){t.n=4;break}return e.innerHTML='<div class="analects-error">æš‚æ— æ•°æ®</div>',t.a(2);case 4:return i=new Date,c=Math.floor(Date.UTC(i.getFullYear(),i.getMonth(),i.getDate())/864e5)%s,o="".concat(this.apiBaseUrl,"/analects_entries?select=id,chapter,section_number,original_text,translation,annotation&order=id.asc&limit=1&offset=").concat(c),t.n=5,this._fetch(o);case 5:if(l=t.v,d=l.data,h=(d||[])[0]){t.n=6;break}return e.innerHTML='<div class="analects-error">æœªæ‰¾åˆ°æ¯æ—¥è®ºè¯­</div>',t.a(2);case 6:e.innerHTML='\n        <div class="analects-card">\n          <div class="analects-card-header">\n            <h3 class="analects-card-title">ğŸ“œ æ¯æ—¥è®ºè¯­</h3>\n            <div class="analects-card-subtitle">'.concat(this._fmtChapter(h),'</div>\n          </div>\n          <div class="analects-card-body">\n            <div class="analects-text">').concat(this._safe(h.original_text),"</div>\n            ").concat(h.translation?'<div class="analects-subtext">'.concat(this._safe(h.translation),"</div>"):"","\n            ").concat(h.annotation?'<div class="analects-subtext muted">'.concat(this._safe(h.annotation),"</div>"):"","\n          </div>\n        </div>\n      "),t.n=8;break;case 7:t.p=7,f=t.v,e.innerHTML='<div class="analects-error">åŠ è½½å¤±è´¥ï¼š'.concat(f.message,"</div>");case 8:return t.a(2)}},t,this,[[2,7]])})),function(t){return l.apply(this,arguments)})},{key:"_fmtChapter",value:function(t){var e=null!=t.chapter?String(t.chapter):"",n=null!=t.section_number?String(t.section_number):"";return e&&n?"ç¬¬ ".concat(e," ç¯‡ Â· ç¬¬ ").concat(n," ç« "):e?"ç¬¬ ".concat(e," ç¯‡"):""}},{key:"_safe",value:function(t){return(t||"").replace(/[&<>]/g,function(t){return{"&":"&amp;","<":"&lt;",">":"&gt;"}[t]})}},{key:"renderSearchInterface",value:(o=f(u().m(function t(e){var n,r,a,s,c,o,l,d,h,p,v,y,b,m,g,_,w=this;return u().w(function(t){for(;;)switch(t.n){case 0:if(e){t.n=1;break}return t.a(2);case 1:return e.innerHTML=this._searchSkeleton(),n=e.querySelector("#analects-keyword"),r=e.querySelector("#analects-search-btn"),a=e.querySelector("#analects-results"),s=e.querySelector("#analects-status"),c=e.querySelector("#analects-load-more-btn"),o=e.querySelector("#chapter-filters"),l=e.querySelector("#character-filters"),d=e.querySelector("#argument-filters"),h=e.querySelector("#proverb-filters"),s.textContent="è¯·è¾“å…¥å…³é”®è¯æˆ–é€‰æ‹©ç­›é€‰åç‚¹å‡»â€œæœç´¢â€ã€‚",t.n=2,Promise.all([this.getChapters(),this.getCharacters(),this.getArguments(),this.getProverbs()]);case 2:p=t.v,v=i(p,4),y=v[0],b=v[1],m=v[2],g=v[3],this._renderChapterChips(o,y),this._renderMultiChips(l,b,this.selected.characters),this._renderMultiChips(d,m,this.selected.arguments),this._renderMultiChips(h,g,this.selected.proverbs),r.addEventListener("click",f(u().m(function t(){var e;return u().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,w._startSearch({keyword:(n.value||"").trim(),characterIds:Array.from(w.selected.characters.keys()),argumentIds:Array.from(w.selected.arguments.keys()),proverbIds:Array.from(w.selected.proverbs.keys()),chapter:(null===(e=w.selected.chapter)||void 0===e?void 0:e.id)||"all"},{results:a,statusBar:s,loadMoreBtn:c});case 1:return t.a(2)}},t)}))),c.addEventListener("click",f(u().m(function t(){return u().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,w._loadMore({results:a,statusBar:s,loadMoreBtn:c});case 1:return t.a(2)}},t)}))),_=function(){var t=f(u().m(function t(){return u().w(function(t){for(;;)switch(t.n){case 0:if(w.state.didSearch&&!w.state.isLoading&&w.state.hasMore){t.n=1;break}return t.a(2);case 1:if(!(c.getBoundingClientRect().top<window.innerHeight+120)){t.n=2;break}return t.n=2,w._loadMore({results:a,statusBar:s,loadMoreBtn:c});case 2:return t.a(2)}},t)}));return function(){return t.apply(this,arguments)}}(),window.addEventListener("scroll",_);case 3:return t.a(2)}},t,this)})),function(t){return o.apply(this,arguments)})},{key:"_searchSkeleton",value:function(){return'\n      <div class="analects-card">\n        <div class="analects-card-header">\n          <h3 class="analects-card-title">ğŸ” è®ºè¯­æŸ¥è¯¢</h3>\n          <div class="analects-searchbar">\n            <input id="analects-keyword" class="analects-input" placeholder="è¾“å…¥å…³é”®è¯ï¼ˆåŸæ–‡/è¯‘æ–‡/æ³¨é‡Šï¼‰">\n            <button id="analects-search-btn" class="analects-btn primary">æœç´¢</button>\n          </div>\n        </div>\n        <div class="analects-card-body">\n          <div class="analects-filters">\n            <div class="analects-filter">\n              <div class="analects-filter-title">ç« èŠ‚</div>\n              <div id="chapter-filters" class="analects-tag-cloud"></div>\n            </div>\n            <div class="analects-filter">\n              <div class="analects-filter-title">äººç‰©</div>\n              <div id="character-filters" class="analects-tag-cloud"></div>\n            </div>\n            <div class="analects-filter">\n              <div class="analects-filter-title">è®ºç‚¹</div>\n              <div id="argument-filters" class="analects-tag-cloud"></div>\n            </div>\n            <div class="analects-filter">\n              <div class="analects-filter-title">è°šè¯­</div>\n              <div id="proverb-filters" class="analects-tag-cloud"></div>\n            </div>\n          </div>\n          <div id="analects-status" class="analects-status muted"></div>\n          <div id="analects-results" class="analects-results"></div>\n          <div class="analects-loadmore">\n            <button id="analects-load-more-btn" class="analects-btn">åŠ è½½æ›´å¤š</button>\n          </div>\n        </div>\n      </div>\n    '}},{key:"_renderChapterChips",value:function(t,e){var n=this;t.innerHTML="";var r=this._chip({id:"all",name:"å…¨éƒ¨ç« èŠ‚"},!0,!0);t.appendChild(r);var a=function(e){t.querySelectorAll(".analects-chip").forEach(function(t){return t.classList.remove("selected")}),e.classList.add("selected"),n.selected.chapter={id:e.dataset.id,name:e.dataset.name};var r=t.querySelector(".analects-chip.all-option");r&&(e===r?r.classList.add("selected"):r.classList.remove("selected")),n._resetPaging()};r.addEventListener("click",function(){return a(r)}),(e||[]).forEach(function(e){var r=n._chip({id:String(e.id),name:String(e.name)},!1,!1);r.addEventListener("click",function(){return a(r)}),t.appendChild(r)})}},{key:"_renderMultiChips",value:function(t,e,n){var r=this;t.innerHTML="",(e||[]).forEach(function(e){var a=r._chip({id:String(e.id),name:String(e.name||e.title||e.content||e.id)},!1,!1);a.addEventListener("click",function(){var t=a.dataset.id,e=a.dataset.name;a.classList.contains("selected")?(a.classList.remove("selected"),n.delete(t)):(a.classList.add("selected"),n.set(t,e)),r._resetPaging()}),t.appendChild(a)})}},{key:"_chip",value:function(t,e,n){var r=document.createElement("label");return r.className="analects-chip".concat(n?" all-option":"").concat(e?" selected":""),r.dataset.id=String(t.id),r.dataset.name=String(t.name),r.innerHTML='\n      <input type="'.concat(n?"radio":"checkbox",'" ').concat(e?"checked":"",' aria-hidden="true" tabindex="-1">\n      <span>').concat(this._safe(t.name),"</span>\n    "),r}},{key:"_resetPaging",value:function(){this.state.page=0,this.state.hasMore=!1,this.state.totalCount=0,this.state.didSearch=!1}},{key:"_startSearch",value:(s=f(u().m(function t(e,n){var r,s,i,c,o,l;return u().w(function(t){for(;;)switch(t.p=t.n){case 0:return r=++this.state.searchToken,this.state.isLoading=!0,this.state.page=0,this.state.didSearch=!0,this.state.currentFilters=a({},e),n.statusBar.textContent="ğŸ” æœç´¢ä¸­...",n.results.innerHTML='<div class="analects-loading">æ­£åœ¨æœç´¢...</div>',n.loadMoreBtn.disabled=!0,t.p=1,t.n=2,this.fetchEntries(this.state.currentFilters,0,this.state.pageSize);case 2:if(s=t.v,i=s.data,c=s.totalCount,o=s.hasMore,r===this.state.searchToken){t.n=3;break}return t.a(2);case 3:this.state.page=1,this.state.hasMore=o,this.state.totalCount=c||i.length,n.results.innerHTML="",this._renderList(n.results,i),this.state.hasMore?n.statusBar.textContent="å…±æ‰¾åˆ° ".concat(this.state.totalCount," æ¡ç»“æœï¼Œæ»šåŠ¨æˆ–è€…ç‚¹å‡»åŠ è½½æ›´å¤š"):n.statusBar.textContent=i.length>0?"å·²åŠ è½½å®Œæ¯•":"æœªæ‰¾åˆ°åŒ¹é…çš„ç»“æœ",n.loadMoreBtn.disabled=!this.state.hasMore,t.n=5;break;case 4:t.p=4,l=t.v,n.results.innerHTML='<div class="analects-error">æœç´¢å¤±è´¥ï¼š'.concat(l.message,"</div>"),n.statusBar.textContent="æœç´¢å¤±è´¥";case 5:return t.p=5,this.state.isLoading=!1,t.f(5);case 6:return t.a(2)}},t,this,[[1,4,5,6]])})),function(t,e){return s.apply(this,arguments)})},{key:"_loadMore",value:(r=f(u().m(function t(e){var n,r,a,s,i;return u().w(function(t){for(;;)switch(t.p=t.n){case 0:if(this.state.didSearch&&!this.state.isLoading&&this.state.hasMore){t.n=1;break}return t.a(2);case 1:return n=this.state.searchToken,this.state.isLoading=!0,e.loadMoreBtn.disabled=!0,e.loadMoreBtn.textContent="åŠ è½½ä¸­...",t.p=2,t.n=3,this.fetchEntries(this.state.currentFilters,this.state.page,this.state.pageSize);case 3:if(r=t.v,a=r.data,s=r.hasMore,n===this.state.searchToken){t.n=4;break}return t.a(2);case 4:this.state.page+=1,this.state.hasMore=s,this._renderList(e.results,a),this.state.hasMore?(e.statusBar.textContent="å…±æ‰¾åˆ° ".concat(this.state.totalCount," æ¡ç»“æœï¼Œæ»šåŠ¨æˆ–è€…ç‚¹å‡»åŠ è½½æ›´å¤š"),e.loadMoreBtn.disabled=!1,e.loadMoreBtn.textContent="åŠ è½½æ›´å¤š"):(e.statusBar.textContent="å·²åŠ è½½å®Œæ¯•",e.loadMoreBtn.textContent="å·²åŠ è½½å®Œæ¯•"),t.n=6;break;case 5:t.p=5,i=t.v,e.statusBar.textContent="åŠ è½½æ›´å¤šå¤±è´¥ï¼š".concat(i.message),e.loadMoreBtn.disabled=!1,e.loadMoreBtn.textContent="åŠ è½½æ›´å¤š";case 6:return t.p=6,this.state.isLoading=!1,t.f(6);case 7:return t.a(2)}},t,this,[[2,5,6,7]])})),function(t){return r.apply(this,arguments)})},{key:"_renderList",value:function(t,e){var n=this,r=document.createDocumentFragment();(e||[]).forEach(function(t){var e=document.createElement("div");e.className="analects-item",e.innerHTML='\n        <div class="meta">'.concat(n._fmtChapter(t),'</div>\n        <div class="text">').concat(n._safe(t.original_text),"</div>\n        ").concat(t.translation?'<div class="subtext">'.concat(n._safe(t.translation),"</div>"):"","\n        ").concat(t.annotation?'<div class="subtext muted">'.concat(n._safe(t.annotation),"</div>"):"","\n      "),r.appendChild(e)}),t.appendChild(r)}}],e&&p(t.prototype,e),n&&p(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,s,o,l,d,h,v,y}();return e=e.default}()});
//# sourceMappingURL=analects.min.js.map