<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>我的笔记 - 论语SDK</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/v2/analects.css">
  <script defer src="https://unpkg.com/lucide@latest"></script>
  <style>
    body { font-family: 'Inter', sans-serif; background-color: #f8fafc; }
    h1, h2, h3 { font-family: 'Noto Serif SC', serif; }
    #toast {
      z-index: 2000 !important;
    }
  </style>
</head>
<body class="page-with-sticky-header text-gray-800 antialiased">
  <header id="global-header-wrapper"></header>
  <div class="container mx-auto max-w-3xl px-4 py-8">

	<header class="text-center mb-8 border-b pb-4 page-header">
	      <h1 class="text-3xl md:text-4xl font-bold text-gray-900">我的笔记</h1>
	      <p class="text-lg text-gray-500 mt-2">温故而知新，可以为师矣</p>
	      <a href="/" class="text-blue-600 hover:underline mt-4 inline-block">&larr; 返回首页</a>

	      <div class="mt-6 max-w-lg mx-auto">
	        <div class="relative">
	          <span class="absolute inset-y-0 left-0 flex items-center pl-3">
	            <svg class="h-5 w-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
	              <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd" />
	            </svg>
	          </span>
	          <input id="notes-search-input" type="search"
	                 class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500"
	                 placeholder="在您的笔记中搜索...">
	        </div>
	      </div>

        <div id="global-comparison-controls" class="mt-4 text-center" style="display: none;">
         <label for="global-comparison-toggle" class="flex items-center justify-center cursor-pointer text-sm text-gray-600">
          <input type="checkbox" id="global-comparison-toggle" class="mr-2">
          <span>显示全部对照笔记</span>
         </label>
        </div>

	</header>

        <button id="print-pdf-btn" class="print-button">
  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 6 2 18 2 18 9"></polyline><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path><rect x="6" y="14" width="12" height="8"></rect></svg>
  <span>打印 / 保存为PDF</span>
        </button>

	<main id="notes-list-container" class="space-y-8">
	    <div class="verse-card-skeleton">
            <div class="skeleton-block" style="height: 32px; width: 80%; margin-bottom: 24px;"></div>
            <div class="skeleton-block" style="height: 24px; width: 100%; margin-bottom: 12px;"></div>
            <div class="skeleton-block" style="height: 24px; width: 100%; margin-bottom: 24px;"></div>
            <div class="skeleton-block" style="height: 40px; width: 100%;"></div>
        </div>
        <div class="verse-card-skeleton">
            <div class="skeleton-block" style="height: 32px; width: 70%; margin-bottom: 24px;"></div>
            <div class="skeleton-block" style="height: 24px; width: 100%; margin-bottom: 12px;"></div>
            <div class="skeleton-block" style="height: 24px; width: 100%; margin-bottom: 24px;"></div>
            <div class="skeleton-block" style="height: 40px; width: 100%;"></div>
        </div>
	</main>

  </div>

  <footer class="container mx-auto max-w-3xl px-4 mt-10 md:mt-12 pt-10 border-t border-gray-200">
    <div class="text-center text-sm text-gray-500">
        <p>&copy; <span id="year"></span> 论语SDK. Made with ❤️ by <a href="https://lehua.li" class="text-blue-600 hover:underline">lehua.li</a></p>
    </div>
  </footer>

  <div id="analects-global-widget-container"></div>

  <script type="module" src="/v2/analects.js"></script>
<script type="module">
 (async () => {
  let sdk;
  try {
    sdk = new AnalectsSDK({
      supabaseUrl: 'https://btqbtibvevglwcpiewyu.supabase.co',
      supabaseKey: 'sb_publishable_Kl_dygwfqk0Uey1G-0rj3A_4sbCgnet'
    });

    sdk.renderGlobalHeader();
    await sdk.init();

    // [修改] 调用更新后的函数名和容器ID
    await sdk.renderMyNotesPage(document.getElementById('notes-list-container'));
    // [新增] 为打印按钮绑定点击事件
    const printBtn = document.getElementById('print-pdf-btn');
     if (printBtn) {
       printBtn.addEventListener('click', () => {
         window.print();
         });
    }
    // [修改] 调用更新后的函数名和元素ID
    sdk.initializeNotesSearch(
      document.getElementById('notes-search-input'),
      document.getElementById('notes-list-container')
    );

    const yearEl = document.getElementById('year');
    if (yearEl) {
      yearEl.textContent = new Date().getFullYear();
    }

  } catch (e) {
    console.error("AnalectsSDK failed to initialize.", e);
    // [修改] 更新容器ID
    document.getElementById('notes-list-container').innerHTML = '<div class="text-center text-red-500 py-8">SDK 初始化失败，请检查配置。</div>';
  }

  })();
</script>

</body>
</html>